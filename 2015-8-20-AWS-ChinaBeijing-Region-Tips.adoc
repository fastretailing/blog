<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>AWS China(Beijing) Region Tips</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="//fastretailing.github.io/blog/themes/Roon/favicon.ico">

    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:400,700,400italic,700italic|Open+Sans:400italic,700italic,700,400">
    <link rel="stylesheet" type="text/css" href="//fastretailing.github.io/blog/themes/Roon/assets/css/screen.css?v=1.0.0" />

    <link rel="canonical" href="https://fastretailing.github.io/blog2015-8-20-AWS-ChinaBeijing-Region-Tips.adoc" />
    
    <meta property="og:site_name" content="FAST RETAILING Developers Blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="AWS China(Beijing) Region Tips" />
    <meta property="og:description" content="Hi, there, my name is Keito Fukuda, a lead technical architect at Fast Retailing. Today I would like to talk about AWS China(Beijing) region since it is very unique from all other AWS regions and you may would like..." />
    <meta property="og:url" content="https://fastretailing.github.io/blog2015-8-20-AWS-ChinaBeijing-Region-Tips.adoc" />
    <meta property="article:published_time" content="2015-08-19T15:00:00.000Z" />
    <meta property="article:modified_time" content="2015-09-29T05:55:05.874Z" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="AWS China(Beijing) Region Tips" />
    <meta name="twitter:description" content="Hi, there, my name is Keito Fukuda, a lead technical architect at Fast Retailing. Today I would like to talk about AWS China(Beijing) region since it is very unique from all other AWS regions and you may would like..." />
    <meta name="twitter:url" content="https://fastretailing.github.io/blog2015-8-20-AWS-ChinaBeijing-Region-Tips.adoc" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "FAST RETAILING Developers Blog",
    "author": {
        "@type": "Person",
        "name": "Keito Fukuda",
        "image": "https://avatars.githubusercontent.com/u/4442949?v=3",
        "url": "undefined/author/undefined",
        "sameAs": null
    },
    "headline": "AWS China(Beijing) Region Tips",
    "url": "https://fastretailing.github.io/blog2015-8-20-AWS-ChinaBeijing-Region-Tips.adoc",
    "datePublished": "2015-08-19T15:00:00.000Z",
    "dateModified": "2015-09-29T05:55:05.874Z",
    "description": "Hi, there, my name is Keito Fukuda, a lead technical architect at Fast Retailing. Today I would like to talk about AWS China(Beijing) region since it is very unique from all other AWS regions and you may would like..."
}
    </script>

    <meta name="generator" content="Ghost ?" />
    <link rel="alternate" type="application/rss+xml" title="FAST RETAILING Developers Blog" href="https://fastretailing.github.io/blog/rss" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
</head>
<body class="post-template  noimage">

    


    <article role="main" class="">
        <header>
            <a href="https://fastretailing.github.io/blog" id="home_link">«</a>
            <div class="meta"><time datetime="2015-08-20"><a href="2015-8-20-AWS-ChinaBeijing-Region-Tips.adoc">August 20, 2015</a></time> <span class="count" id="js-reading-time"></span></div>
            <h1>AWS China(Beijing) Region Tips</h1>
        </header>

        <div class="text" id="js-post-content">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Hi, there, my name is Keito Fukuda, a lead technical architect at Fast Retailing.
Today I would like to talk about AWS China(Beijing) region since it is very unique from all other AWS regions and you may would like to know the discrepancies in advance of you starting to use it without making some efforts to figure it out on your own.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fast_retailing">Fast Retailing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let me start with a little bit talking about our company Fast Retailing as there are some chances that you hear very first time and have no idea about us.
We Fast Retailing is a fast growing global leading apparel company and a holding company which owns various global apparel brands underneath such as UNIQLO, GU, they are born in Japan and rapidly spreading out to global markets. Theory, JBrand, they are originally from US but both have global penetration and large number of customers(funs) all over the world. Last but not least, Comptoir des Cotonniers and Princesse tam tam, which are from France.
As we have global reachability, of course we aggressively take advantage of AWS and its global regions for our systems. We as of today utilize Tokyo, Singapore, Virginia, California, Sydney, Ireland, Frankfrut, then of course China(Beijing) regions to provide our services to our global customers as well as systems to our global employees. Especially China(Beijing) region is pretty important for us as it is our 2nd biggest market generating huge profit, besides there are some challenges due to some unique legal and infrastructure restrictions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_web_service_to_china">Web Service to China</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As described above, when we provide a web service in mainland China, there are some difficulties. I will quickly list up 2 significant challenges below and talk about them in detail one by one in the following section.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ICP Recordal/License</p>
</li>
<li>
<p>Great Firewall</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_icp_recordal_license">ICP Recordal/License</h3>
<div class="paragraph">
<p>As you all may know, if you provide a web service in mainland China, it is necessary to acquire an ICP(Internet Content Provider) recordal or license from the China government. This recordal/license requires us to have a legal entity inside of China and go though a required procedure. In addition, once you acquired it, you are mandated to put it at the bottom of all of your web pages for China.
We Fast Retailing do hold several ICP recordals for our brands to provide web contents in mainland China as you can see below. We do not have any ICP license as all online commercial transactions for our brands are basically completed in the 3rd party platform(Taobao: tmall.com). They have an authorized ICP license on behalf of all tenants.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Fast Retailing ICP Recordal List</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Domain</th>
<th class="tableblock halign-left valign-top">Recordal No.</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqlo.com</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">沪ICP备09003223号-4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uniqlo.cn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">沪ICP备09003223号-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gu-global.com</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">沪ICP备13017798号-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fastretailing.com</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">沪ICP备09003223号-3</p></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="http://fastretailing.github.io/blog/images/china_icp_footer.png" alt="china icp footer.png">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_great_firewall">Great Firewall</h3>
<div class="paragraph">
<p>This is another very well-known unique restriction in mainland China. You can find what it is and how it works in somewhere online(Please just google it or just jump to <a href="https://en.wikipedia.org/wiki/Great_Firewall">wikipedia</a>). But in a nutshell, all inbound/outbound traffics on HTTP(80)/HTTPs(443) are monitored and can be blocked by China government.
Especially when traffic goes through a boundery between inside and outside of mainland China, traffic roundtrip would be  extremely slow.
Even if network traffic completes only inside of China, it is still considered to be unstable especially if traffic goes beyond a boundary between North side and South side as there are 2 different network careers dominating each area. Because of these reasons, when you provide web contents to mainland China, you need to pay attention on huge network latency in your system architecture design. This is the biggest reason which would make you want to have a completely independent infrastructure inside of mainland China to overcome this issue and be able to provide sufficient user experience to your China customers or employees.</p>
</div>
</div>
</div>
</div>
<h1 id="_aws_china_beijing_region_uniqueness" class="sect0">AWS China(Beijing) Region Uniqueness</h1>
<div class="paragraph">
<p>Okay, then let me deep dive on what are the differences exactly from here. Because of the China unique restrictions described in the prior section, when you set up your web service in AWS China(Beijing) region, there are several consideration points you need to keep in mind. Here I will tell you each one of them which we have discovered so far through our operation in China(Beijing) region.</p>
</div>
<div class="sect1">
<h2 id="_account">Account</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First of all, let me talk about AWS account. This is one of things which work in different way from all other AWS regions. In order to use China region, you need a completely independent account, which is dedicated only for China region and given only when you are authorized by AWS. Unlike Global AWS account, you cannot create your account on the fly by yourself. You first need to submit your information <a href="https://www.amazonaws.cn/en/sign-up/">here</a>, then have to wait to get it verified and authorized.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_billing">Billing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Even if you have multi AWS accounts, one of great features for billing which you can use in Global account is <code>Consolidated Billing</code>, which allows you to consolidate all billings associated with all your accounts and let you make a single payment at once. However unfortunately this does not cover AWS China account. Once you get a China account, you need to register your billing information separately from your Global account and it cannot be consolidated. Besides, a bank account to make payment is also different from Global account, which sometimes make it tricky to get yourself ready to pay, especially you work for a large company and need to register it in your company.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_support_plan">Support Plan</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Similar to billing, as we cannot consolidate our China account with any other Global accounts, even if you already subscribe <a href="https://aws.amazon.com/premiumsupport/">AWS support plan</a>, that support can not be applied and cover your China account. If you need intensive support from AWS, you have to subscribe <a href="https://www.amazonaws.cn/en/support-plans/">another support plan</a> dedicated only for your China account.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_service_availability">Service Availability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When it comes to AWS service coverage and availability. As of writing, 2015/08/20, there are plenty of services we can already use as listed below.
EC2, S3, StorageGateway, Glacier, VPC, Direct Connect, IAM, Trusted Advisor, CloudTrail, CloudWatch, DynamoDB, ElasticCache, RDS, CloudFormation, EMR, Kinesis, SNS, SQS, SWF</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://fastretailing.github.io/blog/images/china_service_list.png" alt="china service list.png">
</div>
</div>
<div class="paragraph">
<p>We are really looking forward to Lambda support and API Gateway as we will be heavily relying on these 2 services to efficiently build and maintain a bunch of micro services down the road. I strongly hope that they will become available even in China region soon.
Another AWS service which everybody needs but is not available yet is <code>CloudFront</code>. As I said, even if you have your system up and running in mainland China, there would be still some network instability you and your system users might face. This would make you want to have CDN(Contents Delivery Network) between your users and your system inside of China. As <code>CloudFront</code> is not ready yet in China region, we Fast Retailing utilize both <code>Akamai</code> and <code>China Cache</code> as CDN in front of our systems.
For more details and the latest information, please refer to <a href="http://docs.amazonaws.cn/en_us/aws/latest/userguide/services.html">the official online document</a> maintained by AWS.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_icp_recordal_license_2">ICP Recordal/License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As mentioned above, it is a regulation to acquire an ICP recordal/license whenever you provide web contents over HTTP(80)/HTTPs(443) in mainland China. This is the reason that even after you set up your web service on top of EC2, S3 or whatever, you still cannot access to your web service from the Internet(BTW, all other traffic other than HTTP/HTTPs are fine). Very first time when we found that this incident, we really freaked out and had no idea what was happening&#8230;&#8203;(yes, we should have read through all instructions upfront). You would not reach your web server without your ICP recordal/license No. associated on your AWS China account. In order to get this done, you can either reach out to your AWS counterpart to get a help or directly send an email to <code>Sinnet</code>, who is an IDC-licensed provider responsible for supporting and verifying ICP recordal/license for AWS customers, at <code>My Account</code> on your own to have them register it. This registration process and getting your ICP recordal/license verified would take around a week(in our case, 5 business days). Then you would finally get your web service all ready.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://fastretailing.github.io/blog/images/china_icp_license.png" alt="china icp license.png">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mfa">MFA</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Of course, protecting your account is one of very important things you are also responsible for. In our case, we have a strict internal regulation to enable MFA(Multi Factor Authentication) to all AWS administrative accounts. In other word, we have been simply counting on MFA for all of our Global accounts. However, unfortunately MFA is not available yet in China account, which was actually a huge surprise for us. We cannot simply rely on it like all other Global accounts to make your account secure. I guess only one thing we can do for now then is to make your administrative account password as complex as possible, and that is what we do as of today. We are now pushing AWS team really hard to get it ready. Let&#8217;s stay patient without losing the hope.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ami">AMI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Do you share and reuse your AMI(Amazon Machine Image) across accounts or regions? Unfortunately that is another restriction in China account. We Fast Retailing also heavily rely on AMI to make infra set-up as fast and efficient as possible. AMI is just awesome. Having said that, we are not allowed to copy an AMI taken in other global regions or your other accounts. So basically you need to set up your system from middleware setup to deploying your app codes all on your own at very first time. Once you set it up, you can take an AMI out of it and use it to spin up another instance you need.
In addition, as you can easily imagine, yes, you cannot take advantage of AWS Marketplace either. This would sometimes make huge implication to your setup operation.
As for Community AMI, there are some Community AMIs already available even in China region, but they are completely separated from Community AMIs under Global account. You would find only very limited AMIs there as of today(2015/08/20). So it is recommended to check availability of an Community AMI you would like to use in China account beforehand.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_auto_recovery">Auto-Recovery</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We do generally set Auto-Recovery on EC2 instances, especially when our EC2 based system cannot be run together with multi-instances and it is really difficult to have high-availability. Auto-Recovery brings us huge help in minimizing down-time of your system without any manual operation on the fly in case your instance somehow goes down. However unfortunately, Auto-Recovery is not ready yet in China region.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_admin_console">Admin Console</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I hope you do not have any problem in reading English, then you are totally fine. However unlike Global accounts which support multi-languages in admin console. Admin console of China account is only in English and Simplified Chinese as of today. You can change the language in <code>Console Preferences</code>. This is another difference from Global account.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="http://fastretailing.github.io/blog/images/china_admin_console.png" alt="china admin console.png">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Today, I touched on AWS China(Beijing) region and described some outstanding uniquenesses you should be aware of prior to you start using it. As you saw above, there are many differences compared to all other global regions which you usually use. Some differences may be filled up in the future, but there are still some differences even AWS cannot do anything on due to China legal regulation. I hope you were able to at least get a sense of how different it is and what you need to keep in mind here. Please stay tuned for our upcoming article.</p>
</div>
</div>
</div>
        </div>

        <menu>
            <a href="" id="btn_share" class="btn" title="Share">
                <span aria-hidden="true" data-icon="S"></span>
                <strong>Share</strong>
            </a>
            <a href="http://twitter.com/share?text=AWS%20China(Beijing)%20Region%20Tips&url=https://fastretailing.github.io/blog2015-8-20-AWS-ChinaBeijing-Region-Tips.adoc" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" id="btn_comment" class="btn" target="_blank">
                <span aria-hidden="true" data-icon="C"></span> Comment on Twitter
            </a>
        </menu>


        <footer class="post-footer" role="contentinfo">

            <div class="vcard">
                <!-- <a href="https://fastretailing.github.io/blog/rss" id="btn_feed" class="btn" title="Feed" target="_blank">
                    <span aria-hidden="true" data-icon=")"></span>
                    <strong>Feed</strong>
                </a> -->

                <a href="" class="photo">
                    <span style="background-image: url('https://avatars.githubusercontent.com/u/4442949?v=3');">
                        <img src="https://avatars.githubusercontent.com/u/4442949?v=3" alt="Keito Fukuda">
                    </span>
                </a>

                <div class="details">
                    <h4><a href="" class="url n">Keito Fukuda</a></h4>
                    Tokyo, Japan<br>
                    
                </div>
            </div>

           <div id="user_bio">
                <div class="inner">
                    Please find our current career opportunities below and pass them along to qualified candidates. We look forward to hearing from you!
                </div>
                <button id="work_with_us_btn" onclick="location.href='http://www.fastretailing.com/employment/ja/fastretailing/jp/career/it/'">
                    Work with Us
                </button>
            </div>
        </footer>




    </article>

    <div id="share_modal">
        <div class="wrap">
            <div class="inner">
                <header>
                    Share
                    <a href="" class="close" title="Close">&times;</a>
                </header>

                <div class="roon-share-links">
                    <a href="https://twitter.com/share" class="twitter-share-button" data-dnt="true">Tweet</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

                    <div id="fb-elems">
                        <div id="fb-root"></div>
                        <script>(function(d, s, id) {
                        var js, fjs = d.getElementsByTagName(s)[0];
                        if (d.getElementById(id)) return;
                        js = d.createElement(s); js.id = id;
                        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=463438580397968";
                        fjs.parentNode.insertBefore(js, fjs);
                        }(document, 'script', 'facebook-jssdk'));</script>
                        <div class="fb-like" data-send="false" data-layout="button_count" data-width="110" data-show-faces="false" data-font="arial"></div>
                    </div>

                    <div id="pinit-btn">
                        <a href="//pinterest.com/pin/create/button/?url=https://fastretailing.github.io/blog2015-8-20-AWS-ChinaBeijing-Region-Tips.adoc&amp;description=AWS%20China(Beijing)%20Region%20Tips-FAST%20RETAILING%20Developers%20Blog " data-pin-do="buttonPin" data-pin-config="beside"><img src="//assets.pinterest.com/images/pidgets/pin_it_button.png"></a>
                        <script type="text/javascript" src="//assets.pinterest.com/js/pinit.js"></script>
                    </div>
                </div>
            </div>
        </div>
    </div>




        <a href="https://fastretailing.github.io/blog" id="blog_badge">
            <span style="background-image: url('http://www.fastretailing.com/jp/images/logo_fr.gif');">FAST RETAILING Developers Blog</span>
        </a>


    <script>

            function get_text(el) {
                ret = "";
                var length = el.childNodes.length;
                for(var i = 0; i < length; i++) {
                    var node = el.childNodes[i];
                    if(node.nodeType != 8) {
                        ret += node.nodeType != 1 ? node.nodeValue : get_text(node);
                    }
                }
                return ret;
            }
            function reading_time () {
                var post_content = document.getElementById('js-post-content');
                if (post_content) {
                    var words = get_text(post_content),
                        count = words.split(/\s+/).length,
                        read_time = Math.ceil((count / 150)),
                        read_time_node = document.createTextNode(read_time + ' min read');
                    document.getElementById('js-reading-time').appendChild(read_time_node);
                }
            }

        function no_schema_links () {
            var links = document.querySelectorAll('.js-remove-domain-schema');
            if (links) {
                for (i = 0; i < links.length; ++i) {
                    var link = links[i],
                        text = link.innerHTML,
                        no_schema = text.replace(/.*?:\/\//g, "");
                    link.innerHTML = no_schema;
                }
            }
        }

        window.onload = function () {
            no_schema_links();

            reading_time();
        }
    </script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();      
      </script>

        <script>
            $(function(){
                var share_modal = $("#share_modal"),
                    update_social_links = true;

                $("#btn_share").click(function(){
                    var that = $(this);
                    share_modal.fadeIn(200);
                    return false;
                });

                share_modal.click(function(e){
                    if (e.target.className == "wrap" || e.target.id == "share_modal") {
                        share_modal.fadeOut(200);
                    }
                    return false;
                });

                share_modal.find("div.inner > header > a.close").click(function(){
                    share_modal.fadeOut(200);
                    return false;
                });
            });
        </script>


    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-66410914-1', 'auto');
    ga('send', 'pageview');

    </script>

</body>
</html>
